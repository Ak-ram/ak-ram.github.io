name: Move Post Every Minute

on:
  schedule:
    - cron: '* * * * *'

jobs:
  move_post:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Choose post to move
      run: |
        POSTS_DIR="../scheduled_posts"
        TARGET_DIR="../../_posts"  # Replace with the actual target directory path

        # Choose the post with the earliest creation time
        POST_TO_MOVE=$(ls -1t $POSTS_DIR | head -n 1)
        mv "$POSTS_DIR/$POST_TO_MOVE" $TARGET_DIR

    - name: Commit and push changes
      run: |
        git config user.name "${{ github.actor }}"
        git config user.email "${{ github.actor }}@users.noreply.github.com"
        git add .
        git commit -m "Move post to target directory"
        git push
